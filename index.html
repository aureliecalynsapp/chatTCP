<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <script src="translations.js"></script>
	<script src="quotes.js"></script>
	<script src="load.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="style.css">
	<link rel="icon" type="image/png" href="/img/logo.png">
	<link rel="apple-touch-icon" href="/img/logo.png">
</head>

<body>
	<div id="welcome-screen">
		<div style="position: fixed; bottom: 10px; width: 100%; text-align: center; pointer-events: none;">
			<span style="background: rgba(0,0,0,0.05); padding: 2px 8px; border-radius: 10px; color: #bbb; font-size: 9px; letter-spacing: 1px;">
				RELEASE 1.6.0
			</span>
		</div>
		<div class="lang-selector-home">
			<select id="lang-select-home" onchange="applyLanguage(this.value)">
				<option value="fr">FranÃ§ais ðŸ‡«ðŸ‡·</option>
				<option value="en">English ðŸ‡¬ðŸ‡§</option>
				<option value="zh">ä¸­æ–‡ ðŸ‡¨ðŸ‡³</option>
			</select>
		</div>

		<div class="welcome-card">
			<h1 id="txt-welcome-title"></h1>
			
			<div id="daily-quote-container">
				<span id="quote-intro" style="font-weight: bold; font-size: 0.9em; color: #3498db;"></span>
				<p id="quote-text">--</p>
			</div>

			<button id="enter-chat-btn"></button>
		</div>
	</div>
    <div id="chat-container">
        <div id="chat-header">
            <div style="font-weight: bold;" id="txt-header-title"></div>

			<div id="clocks-container" style="display:none;">
				<div class="clock-unit">
					<div class="analog-clock" id="them-analog">
						<div class="hand hour"></div>
						<div class="hand minute"></div>
						<div class="center-dot"></div>
					</div>
					<div id="them-city-name">--</div>
				</div>
				<div class="clock-unit">
					<div class="analog-clock" id="me-analog">
						<div class="hand hour"></div>
						<div class="hand minute"></div>
						<div class="center-dot"></div>
					</div>
					<div id="me-city-name">--</div>
				</div>
			</div>
			
            <div class="header-right">
                <a href="/cgu" target="_blank" id="txt-view-cgu"></a>
                <button id="theme-toggle" style="cursor:pointer; border:none; background:none; font-size: 1.2rem;">ðŸŒ™</button>
                <select id="lang-select" onchange="applyLanguage(this.value)" style="cursor: pointer; margin: 5px;">
                    <option value="fr">FranÃ§ais ðŸ‡«ðŸ‡·</option>
                    <option value="en">English ðŸ‡¬ðŸ‡§</option>
                    <option value="zh">ä¸­æ–‡ ðŸ‡¨ðŸ‡³</option>
                </select>
            </div>
			
        </div>
		<div id="chat-wrapper">
			<button id="load-more-btn" style="background:none; border:none; cursor:pointer; display:none;"></button>
		</div>
        <ul id="messages"></ul>
        <div id="typing-indicator"></div>
		<footer id ="chat-footer">
			<form id="form">
				<label for="file-input" style="cursor:pointer; font-size: 1.5em; padding: 5px; margin: 5px;">ðŸ“Ž</label>
				<button type="button" id="emoji-btn">ðŸ˜€</button>
				<button type="button" id="voice-btn">ðŸŽ¤</button>
				<div id="recording-status" style="display:none; color:red; font-size:0.8em; margin: 5px;">
					... <span id="timer">0s</span>
				</div>
				<input type="file" id="file-input" accept="image/*" style="display:none;">
				<textarea id="input" placeholder="Ã‰crivez un message..." rows="1"></textarea>
				<button id="send-btn" type="submit"></button>
			</form>
		</footer>
    </div>

    <script>			 
		var lang = localStorage.getItem('preferred-lang') || (navigator.language.startsWith('fr') ? 'fr' : 'en');
		applyLanguage(lang);

		document.getElementById('enter-chat-btn').addEventListener('click', async () => {
			try {
				await loadJs(); 
				if (typeof initClockEngine === 'function') {
					initClockEngine();
				}				
				if (typeof startSecurityProcess === 'function') {
					startSecurityProcess();
				} else {
					console.error("Le script est chargÃ© mais la fonction est introuvable");
				}
			} catch (err) {
				console.error("Erreur de chargement des scripts :", err);
			}
		});
		
    </script>
</body>
</html>
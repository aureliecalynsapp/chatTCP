var translations = {
    fr: {
        header_title: "ðŸ’¬ Mon Chat SÃ©curisÃ©",
        view_cgu: "ðŸ“œ CGU",
        input_placeholder: "Ã‰crivez ...",
        send_btn: "Envoyer",
        typing: " est en train d'Ã©crire...",
        cgu_title: "Conditions GÃ©nÃ©rales d'Utilisation",
        back_home: "Retour Ã  l'accueil",
        select_lang: "Langue",
		cgu_main_title: "Conditions GÃ©nÃ©rales d'Utilisation",
        last_update: "DerniÃ¨re mise Ã  jour : 30 dÃ©cembre 2025",
        cgu_sec1_title: "1. Nature du Service & Chiffrement",
        cgu_sec1_text: `Cette application propose un service de messagerie privÃ©e utilisant un protocole de chiffrement de bout en bout (AES-256).
Les messages sont verrouillÃ©s sur votre appareil avant l'envoi. L'Ã©diteur agit comme un transporteur neutre et n'a aucun moyen technique de lire vos conversations.`,
        cgu_sec2_title: "2. ResponsabilitÃ© & SÃ©curitÃ©",
        cgu_sec2_text: `L'utilisateur est seul responsable de ses propos et de sa clÃ© de sÃ©curitÃ©.
En cas de perte du mot de passe, les messages ne pourront jamais Ãªtre rÃ©cupÃ©rÃ©s. L'Ã©diteur dÃ©cline toute responsabilitÃ© quant au contenu des Ã©changes.`,
        cgu_sec3_title: "3. Protection des Mineurs",
        cgu_sec3_text: `L'accÃ¨s aux mineurs est soumis Ã  l'accord parental. 
L'application peut intÃ©grer des modules Ã©ducatifs adaptÃ©s pour sensibiliser aux bonnes pratiques du numÃ©rique et Ã  la cyber-courtoisie.`,
        cgu_sec4_title: "4. DonnÃ©es Personnelles (RGPD)",
        cgu_sec4_text: `Nous collectons uniquement votre adresse IP pour motif lÃ©gal et diagnostic technique.
Aucune donnÃ©e n'est cÃ©dÃ©e Ã  des tiers. Les messages sont supprimÃ©s de la base de donnÃ©es dÃ¨s leur effacement par l'utilisateur.`,
        cgu_sec5_title: "5. Mentions LÃ©gales",
        cgu_sec5_text: `Ce site est Ã©ditÃ© Ã  titre privÃ©. HÃ©bergÃ© par Render.com (San Francisco, USA).`,
		prompt_password: "Mot de passe du chat :",
        prompt_secret_key: "Entrez la clÃ© secrÃ¨te de dÃ©chiffrement :",
        prompt_pseudo: "Ton pseudo ?",
        alert_access_denied: "AccÃ¨s refusÃ©",
        alert_key_mandatory: "ClÃ© obligatoire !",
		welcome_title: "Bienvenue",
        enter_chat: "AccÃ©der au Chat SÃ©curisÃ©",
        quote_intro: "La pensÃ©e positive du jour :",
		load_more: "Charger les messages prÃ©cÃ©dents..."
    },
    en: {
        header_title: "ðŸ’¬ My Secure Chat",
        view_cgu: "ðŸ“œ TOS",
        input_placeholder: "Type a message...",
        send_btn: "Send",
        typing: " is typing...",
        cgu_title: "Terms of Service",
        back_home: "Back to home",
        select_lang: "Language",
		cgu_main_title: "Terms and Conditions of Use",
        last_update: "Last updated: December 30, 2025",
        cgu_sec1_title: "1. Service Nature & Encryption",
        cgu_sec1_text: `This application provides a private messaging service using end-to-end encryption (AES-256).
Messages are locked on your device before being sent. The provider acts as a neutral carrier and has no technical means to read your conversations.`,
        cgu_sec2_title: "2. Responsibility & Security",
        cgu_sec2_text: `Users are solely responsible for their messages and security key.
If the password is lost, messages can never be recovered. The provider disclaims all liability regarding the content of exchanges.`,
        cgu_sec3_title: "3. Protection of Minors",
        cgu_sec3_text: `Access for minors is subject to parental consent.
The application may include educational modules to raise awareness about digital best practices and cyber-courtesy.`,
        cgu_sec4_title: "4. Personal Data (GDPR)",
        cgu_sec4_text: `We only collect your IP address for legal reasons and technical diagnostics.
No data is shared with third parties. Messages are deleted from the database as soon as they are erased by the user.`,
        cgu_sec5_title: "5. Legal Notice",
        cgu_sec5_text: `This site is privately edited. Hosted by Render.com (San Francisco, USA).`,
		prompt_password: "Chat password:",
        prompt_secret_key: "Enter the secret decryption key:",
        prompt_pseudo: "Your nickname?",
        alert_access_denied: "Access denied",
        alert_key_mandatory: "Key is mandatory!",
		welcome_title: "Welcome",
        enter_chat: "Enter Secure Chat",
        quote_intro: "Today's positive thought:",
		load_more: "Load previous messages..."
    },
    zh: {
        header_title: "ðŸ’¬ æˆ‘çš„å®‰å…¨èŠå¤©",
        view_cgu: "ðŸ“œ ä½¿ç”¨æ¡æ¬¾",
        input_placeholder: "è¾“å…¥æ¶ˆæ¯...",
        send_btn: "å‘é€",
        typing: " æ­£åœ¨è¾“å…¥...",
        cgu_title: "æœåŠ¡æ¡æ¬¾",
        back_home: "å›žåˆ°é¦–é¡µ",
        select_lang: "è¯­è¨€",
		cgu_main_title: "ä½¿ç”¨æ¡æ¬¾ä¸Žæ¡ä»¶",
        last_update: "æœ€åŽæ›´æ–°ï¼š2025å¹´12æœˆ30æ—¥",
        cgu_sec1_title: "1. æœåŠ¡æ€§è´¨ä¸ŽåŠ å¯†",
        cgu_sec1_text: `æœ¬åº”ç”¨ç¨‹åºæä¾›ç«¯åˆ°ç«¯åŠ å¯† (AES-256) çš„ç§äººæ¶ˆæ¯æœåŠ¡ã€‚
æ¶ˆæ¯åœ¨å‘é€å‰å·²åœ¨æ‚¨çš„è®¾å¤‡ä¸Šé”å®šã€‚ç¼–è¾‘è€…ä½œä¸ºä¸­ç«‹çš„ä¼ è¾“æ–¹ï¼ŒæŠ€æœ¯ä¸Šæ— æ³•è¯»å–æ‚¨çš„å¯¹è¯ã€‚`,
        cgu_sec2_title: "2. è´£ä»»ä¸Žå®‰å…¨",
        cgu_sec2_text: `ç”¨æˆ·å¯¹å…¶è¨€è®ºå’Œå®‰å…¨å¯†é’¥è´Ÿå…¨éƒ¨è´£ä»»ã€‚
å¦‚æžœå¯†ç ä¸¢å¤±ï¼Œæ¶ˆæ¯å°†æ— æ³•æ¢å¤ã€‚ç¼–è¾‘è€…å¯¹äº¤æµå†…å®¹ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚`,
        cgu_sec3_title: "3. æœªæˆå¹´äººä¿æŠ¤",
        cgu_sec3_text: `æœªæˆå¹´äººè®¿é—®éœ€èŽ·å¾—å®¶é•¿åŒæ„ã€‚
åº”ç”¨ç¨‹åºå¯èƒ½åŒ…å«æ•™è‚²æ¨¡å—ï¼Œæ—¨åœ¨æé«˜å¯¹æ•°å­—æœ€ä½³å®žè·µå’Œç½‘ç»œç¤¼ä»ªçš„æ„è¯†ã€‚`,
        cgu_sec4_title: "4. ä¸ªäººæ•°æ® (GDPR)",
        cgu_sec4_text: `æˆ‘ä»¬ä»…å‡ºäºŽæ³•å¾‹åŽŸå› å’ŒæŠ€æœ¯è¯Šæ–­éœ€è¦æ”¶é›†æ‚¨çš„ IP åœ°å€ã€‚
ä¸ä¼šå‘ç¬¬ä¸‰æ–¹æä¾›ä»»ä½•æ•°æ®ã€‚æ¶ˆæ¯åœ¨ç”¨æˆ·åˆ é™¤åŽç«‹å³ä»Žæ•°æ®åº“ä¸­æ¸…é™¤ã€‚`,
        cgu_sec5_title: "5. æ³•å¾‹å£°æ˜Ž",
        cgu_sec5_text: `æœ¬ç½‘ç«™ä¸ºç§äººç¼–è¾‘ã€‚ç”± Render.com (ç¾Žå›½æ—§é‡‘å±±) æ‰˜ç®¡ã€‚`,
		prompt_password: "èŠå¤©å¯†ç ï¼š",
        prompt_secret_key: "è¾“å…¥è§£å¯†å¯†é’¥ï¼š",
        prompt_pseudo: "ä½ çš„æ˜µç§°ï¼Ÿ",
        alert_access_denied: "è®¿é—®è¢«æ‹’ç»",
        alert_key_mandatory: "å¿…é¡»è¾“å…¥å¯†é’¥ï¼",
		welcome_title: "æ¬¢è¿Ž",
        enter_chat: "è¿›å…¥åŠ å¯†èŠå¤©å®¤",
        quote_intro: "ä»Šæ—¥æ­£èƒ½é‡ï¼š",
		load_more: "åŠ è½½åŽ†å²æ¶ˆæ¯..."
    }
};

// Fonction pour appliquer la langue	
function applyLanguage(lang) {
	console.log("Changement de langue vers :", lang);
					
	var t = translations[lang];
	if (!t) {
		console.error("Langue non trouvÃ©e dans translations.js :", lang);
		return;
	}
	
	// Liste des IDs Ã  mettre Ã  jour
	var mapping = {
		'txt-header-title': t.header_title,
		'txt-view-cgu': t.view_cgu,
		'txt-welcome-title': t.welcome_title,
		'enter-chat-btn': t.enter_chat,
		'quote-intro': t.quote_intro,
		'load-more-btn': t.load_more,
		'send-btn' : t.send_btn,
		'input': 'placeholder' // Cas spÃ©cial pour le placeholder
	};
	
	for (let id in mapping) {
		var el = document.getElementById(id);
		if (el) {
			if (mapping[id] === 'placeholder') {
				el.placeholder = t.input_placeholder;
			} else {
				el.innerText = mapping[id];
			}
		} else {
			console.warn("Ã‰lÃ©ment introuvable : " + id);
		}
	}
	// Mettre Ã  jour la citation du jour (depuis quotes.js)
	if (typeof displayDailyQuote === 'function') {
		displayDailyQuote(lang);
	}
	
	// Sauvegarder la langue
	localStorage.setItem('preferred-lang', lang);
			
	// SYNCHRONISATION : On s'assure que les deux sÃ©lecteurs affichent la mÃªme langue
	// On cherche tous les menus de langue et on leur impose la valeur
	var selectors = ['lang-select-home', 'lang-select']; 
	selectors.forEach(id => {
		var el = document.getElementById(id);
		if (el) {
			el.value = lang; // Force l'affichage sur "en", "fr" ou "zh"
		}
	});
		
	// On met Ã  jour le lien vers les CGU pour inclure la langue
	var cguLink = document.getElementById('txt-view-cgu');
	if(cguLink) {
		cguLink.href = `/cgu?lang=${lang}`;
	}
}